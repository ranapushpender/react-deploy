(this["webpackJsonpatko-mvp-frontend"]=this["webpackJsonpatko-mvp-frontend"]||[]).push([[22],{3879:function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a(1),r=a.n(n),i=a(6),c=a(35),l=a(11),o=a(12),s=a(14),u=a(429),m=(a(89),function(e,t){return function(){var a=Object(i.a)(r.a.mark((function a(n){var i,m;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,c.a.updateBasicDetails(e,t);case 3:return 200!==(i=a.sent).status&&204!==i.status||(Object(s.a)("success","Basics details updated successfully."),m=Object(l.f)(i.data),n(u.a(m))),a.abrupt("return",i);case 8:a.prev=8,a.t0=a.catch(0),Object(o.a)(a.t0);case 11:case"end":return a.stop()}}),a,null,[[0,8]])})));return function(e){return a.apply(this,arguments)}}()})},3917:function(e,t,a){},4005:function(e,t,a){"use strict";a.r(t);a(118);var n=a(54),r=a.n(n),i=(a(204),a(52)),c=a.n(i),l=(a(141),a(77)),o=a.n(l),s=(a(38),a(21)),u=a.n(s),m=a(1),d=a.n(m),v=a(6),f=a(8),p=(a(149),a(69)),b=a.n(p),h=a(3865),g=a(13),E=a(78),y=a(0),O=a.n(y),S=a(28),N=a(57),C=a(10),j=a(22),x=a(160),k=a(47),B=a(56),w=a(142),V=a(3879),D=a(89),T=a(97),L=a(11),F=(a(3917),a(2)),P=function(e){return""==e.estdYear&&(e.estdYear=null),e},q=a(25),A=a(15),I=a.n(A),M=q.f().shape({name:q.g().min(2,"Company name must be at least 2 characters long.").max(250,"Company name must not exceed more than 50 characters.").required("Company name is required"),estdYear:q.g().trim().matches(/^[0-9]{4}$/,"Invalid year").nullable(),otherDMCs:q.g().nullable().min(2,"Cannot be less than 2 characters").max(250,"Cannot exceed more than 250 characters"),comments:q.g().nullable().min(2,"Cannot be less than 2 characters").max(250,"Cannot exceed more than 250 characters"),services:q.a().of(q.g()).min(1,"Select at least one service")}),Y=b.a.Text;var z=Object(S.b)((function(e){var t=e.Suppliers,a=e.City,n=t.basicDetails,r=t.root,i=n.data,c=r.tabStatus.status,l=a.cityList;return{services:n.data.services,formValues:i,tabStatus:c,cityList:l}}),(function(e){return{updateBasicDetails:Object(C.b)(V.a,e),refreshSupplierData:Object(C.b)(D.o,e),requestProductServiceActivation:Object(C.b)(D.r,e),requestProductServiceDeactivation:Object(C.b)(D.s,e),getPublishedSuppliersListByType:Object(C.b)(D.h,e),getCityListNoParams:Object(C.b)(w.b,e),getSupplierBasicDetails:Object(C.b)(D.j,e)}}))((function(e){var t=e.servicesOffered,a=Object(L.q)().get("stage"),n=Object(N.i)().id,i=Object(y.useState)({}),l=Object(f.a)(i,2),s=l[0],m=l[1],p=Object(y.useState)([]),b=Object(f.a)(p,2),S=b[0],C=b[1],w=Object(y.useState)([]),V=Object(f.a)(w,2),D=V[0],q=V[1],A=Object(B.a)(),z=Object(f.a)(A,3),G=z[0],J=z[1],K=z[2],W=function(){var t=Object(v.a)(d.a.mark((function t(a,r){var i,c,l;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=r.setSubmitting,t.prev=1,a.parentSupplierName&&(-1==(null===(c=a.parentSupplierName)||void 0===c?void 0:c.indexOf("TCI"))?a.associateOffice=null:a.branchOffice=null),l=P(a),t.next=6,e.updateBasicDetails(n,l);case 6:t.sent&&e.changeTab("kyc-verification"),i(!1),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(1),console.error(t.t0),i(!1);case 15:case"end":return t.stop()}}),t,null,[[1,11]])})));return function(e,a){return t.apply(this,arguments)}}(),R=function(){var t=Object(v.a)(d.a.mark((function t(a){var n,r,i,c,l,o,s=arguments;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=s.length>1&&void 0!==s[1]?s[1]:"branch-office",c=s.length>2?s[2]:void 0,t.next=4,e.getPublishedSuppliersListByType(i,a,c);case 4:l=t.sent,o=null===l||void 0===l||null===(n=l.data)||void 0===n||null===(r=n.content)||void 0===r?void 0:r.map((function(e){return{code:e.businessCode,name:e.name}})),t.t0=i,t.next="branch-office"===t.t0?9:"associate-office"===t.t0?11:13;break;case 9:return C(Object(L.n)(o,[e.formValues.branchOffice?{code:e.formValues.branchOffice,name:e.formValues.parentSupplierName}:{}],"code")),t.abrupt("break",13);case 11:return q(Object(L.n)(o,[e.formValues.associateOffice?{code:e.formValues.associateOffice,name:e.formValues.parentSupplierName}:{}],"code")),t.abrupt("break",13);case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),$=Object(E.debounce)(R,300);return Object(y.useEffect)((function(){var t=function(e){var t;return{values:Object(F.a)(Object(F.a)({},e),{},{city:null===(t=e.city)||void 0===t?void 0:t.code}),cityOptions:e.city}}(e.formValues),a=t.values,n=t.cityOptions;m(a),J(n)}),[e.formValues]),Object(y.useEffect)((function(){R(),R("","associate-office","guide"),e.refreshSupplierData(n,a),e.getCityListNoParams()}),[]),O.a.createElement(x.a,{loadingKey:T.e.replaceAll("/","_"),type:"shimmer"},O.a.createElement("div",{id:"basic-details","data-test":"basic-details",className:"basic-details ".concat(Object(L.m)(e.tabStatus)&&"read-only-mode")},O.a.createElement(g.e,{enableReinitialize:!0,validationSchema:M,initialValues:s,onSubmit:W},(function(i){i.setFieldValue;var l,s,m,d,v,f=i.isSubmitting,p=i.values;return O.a.createElement(O.a.Fragment,null,O.a.createElement(g.d,null,O.a.createElement("div",{className:"mb-20 form-grid grid-2"},O.a.createElement("div",null,O.a.createElement("div",{className:"mb-10"},O.a.createElement(Y,{className:"bold mb-15"},"Name of the supplier *")),O.a.createElement(g.b,{component:j.b,label:"Company Name *",value:p.name,name:"name",type:"name",hasFeedback:!0})),O.a.createElement("div",null,O.a.createElement("div",{className:"mb-10"},O.a.createElement(Y,{strong:!0},"In Existence Since")),O.a.createElement(g.b,{component:j.b,label:"In Existence Since",value:p.estdYear,name:"estdYear",type:"estdYear",validate:function(e){return function(e){var t;return e>I()().year()&&(t="Existence year cannot be more than current year"),t}(e)}}))),O.a.createElement("div",{className:"mb-20 form-grid grid-2"},O.a.createElement("div",null,O.a.createElement("div",{className:"mb-10"},O.a.createElement(Y,{className:"bold mb-15"},"Located At *")),O.a.createElement(g.b,{component:j.d,filterOption:!1,name:"city",label:"Select City *",value:p.city,getPopupContainer:function(){return document.getElementById("basic-details")},optionValueKey:"code",showSearch:!0,selectOptions:G,allowClear:!0,onClear:K,onSearch:K,validate:function(e){if(!e)return"City is required"},hasFeedback:!0}))),O.a.createElement("div",{className:"mb-30"},O.a.createElement(Y,{className:"bold",strong:!0},"Supplier Type *",O.a.createElement(o.a,{placement:"top",title:"Supplier type cannot be changed"},O.a.createElement(h.a,{style:{fontSize:"12px",color:"#333333",marginLeft:"8px"}}))),O.a.createElement("div",{className:"read-only-mode mt-10 form-grid grid-4"},k.p.map((function(e,t){return O.a.createElement("label",{key:t},O.a.createElement(g.b,{as:c.a,type:"radio",name:"type",value:e.value}),O.a.createElement("span",{className:"capitalize"},e.name))})))),O.a.createElement("div",{className:"mb-30"},O.a.createElement(Y,{className:"bold",strong:!0},"Services Offered *"),O.a.createElement("div",{className:"mt-10 form-grid grid-1"},t&&t.map((function(t,i){var c,l;return O.a.createElement("div",{className:"mb-16 form-grid grid-2"},O.a.createElement("div",{className:"flex items-center justify-between"},O.a.createElement("label",{key:i},O.a.createElement(g.b,{name:"services",valuePropName:"checked",as:r.a,type:"checkbox",value:t,disabled:e.services.includes(t)||"hotel"===t&&("indirect"===(null===e||void 0===e||null===(c=e.basic)||void 0===c?void 0:c.type)||"branch-office"===(null===e||void 0===e||null===(l=e.basic)||void 0===l?void 0:l.type))}),O.a.createElement("span",{className:"capitalize ml-10"},t.split("-").join(" "))),O.a.createElement("div",{className:"cursor-pointer"},function(t){var r,i,c,l={transport:e.formValues.transporterComponentStatus,guide:e.formValues.guideComponentStatus,hotel:e.formValues.hotelComponentStatus,activity:e.formValues.activityComponentStatus,"stand-alone-fnb":e.formValues.foodAndBeverageComponentStatus};if(e.services.includes(t)&&null!==l[t]){var o={edited:{status:"edited",actionBtnFn:function(){},actionBtnText:""},"need-activation-approval":{status:"need-activation-approval",actionBtnFn:function(){},actionBtnText:""},"need-deactivation-approval":{status:"need-deactivation-approval",actionBtnFn:function(){},actionBtnText:""},activated:{status:"activated",actionBtnFn:function(){return e.requestProductServiceDeactivation(n,"stand-alone-fnb"==t?"food-and-beverages":t,a)},actionBtnText:"Click to deactivate"},deactivated:{status:"deactivated",actionBtnFn:function(){return e.requestProductServiceActivation(n,"stand-alone-fnb"==t?"food-and-beverages":t,a)},actionBtnText:"Click to activate"}};return O.a.createElement("div",{className:"flex items-center"},O.a.createElement("div",{className:"capitalize product-tag product-tag-".concat(l[t])},null===(r=o[l[t]])||void 0===r||null===(i=r.status)||void 0===i?void 0:i.split("-").join(" ")),O.a.createElement(u.a,{type:"link",className:"ml-10",onClick:function(){var e;return null===(e=o[l[t]])||void 0===e?void 0:e.actionBtnFn(n,t,a)}},null===(c=o[l[t]])||void 0===c?void 0:c.actionBtnText))}}(t))))}))),O.a.createElement(g.a,{name:"services",render:function(e){return O.a.createElement(Y,{type:"danger"},e)}})),O.a.createElement("div",{className:"mb-20 form-grid grid-1"},O.a.createElement("div",{className:"mb-10"},O.a.createElement(Y,{className:"bold",strong:!0},"Other DMCs I work with")),O.a.createElement(g.b,{component:j.b,label:"Other DMCs I work with",value:p.otherDMCs,name:"otherDMCs",type:"otherDMCs"})),O.a.createElement("div",{className:"mb-20 form-grid grid-1"},O.a.createElement("div",null,O.a.createElement("div",{className:"mb-10"},O.a.createElement(Y,{className:"bold",strong:!0},"Anything you want to tell us about yourself")),O.a.createElement(g.b,{component:j.e,label:"Write comments eg. \u201cWe\u2019re the biggest provider in Asia\u201d",value:p.comments,name:"comments",type:"comments",rows:4,validate:function(e){return function(e){var t;return(null===e||void 0===e?void 0:e.length)>2500&&(t="Maximum character limit is 2500."),t}(e)}}))),"associate-office"==(null===(l=e.formValues)||void 0===l?void 0:l.type)?O.a.createElement("div",{className:"mb-40 mt-40"},O.a.createElement(Y,{className:"bold",strong:!0},"Governing Cities *"),O.a.createElement("div",{className:"mt-10 form-grid grid-2"},O.a.createElement(g.b,{component:j.d,value:p.governingLocations,name:"governingLocations",label:"Select governing Cities *",selectOptions:Object(L.n)(null===e||void 0===e||null===(s=e.cityList)||void 0===s?void 0:s.map((function(e){return{name:e.name,value:null===e||void 0===e?void 0:e.code}})),null===(m=e.formValues)||void 0===m||null===(d=m.governingLocationsObjects)||void 0===d?void 0:d.map((function(e){return{name:e.name,value:null===e||void 0===e?void 0:e.code}})),"value"),hasFeedback:!0,showSearch:!0,filterOption:!1,mode:"multiple",validate:function(e){return(null===e||void 0===e?void 0:e.length)?null:"Please select atleast one city"},onSearch:function(t){return e.getCityListNoParams(t)}}))):null,"indirect"==p.type?p.parentSupplierName&&-1!=(null===(v=p.parentSupplierName)||void 0===v?void 0:v.indexOf("TCI"))?O.a.createElement("div",null,O.a.createElement("div",{className:"mb-10"},O.a.createElement(Y,{strong:!0},"Governing branch")),O.a.createElement(g.b,{component:j.d,filterOption:!1,name:"branchOffice",label:"Select Governing Branch *",value:p.branchOffice,selectOptions:S.map((function(e){return{name:e.name,value:null===e||void 0===e?void 0:e.code}})),showSearch:!0,allowClear:!0,onClear:$,onSearch:$,onDropdownVisibleChange:function(e){return!e&&$("")},validate:function(e){return e?"":"Branch is required"}})):O.a.createElement("div",null,O.a.createElement("div",{className:"mb-10"},O.a.createElement(Y,{strong:!0},"Associate Office")),O.a.createElement(g.b,{component:j.d,filterOption:!1,name:"associateOffice",label:"Select Associate Office *",value:p.associateOffice,selectOptions:D.map((function(e){return{name:e.name,value:null===e||void 0===e?void 0:e.code}})),showSearch:!0,onClear:function(){return $("","associate-office","guide")},onSearch:function(e){return $(e,"associate-office","guide")},onDropdownVisibleChange:function(e){return!e&&$("","associate-office","guide")},validate:function(e){return e?"":"Branch is required"}})):null,Object(L.m)(e.tabStatus)?O.a.createElement(O.a.Fragment,null):O.a.createElement("div",{className:"flex flex-start"},O.a.createElement(u.a,{loading:f,type:"primary",htmlType:"submit"},f?"Saving...":"Save & continue"))))}))))}));t.default=z}}]);