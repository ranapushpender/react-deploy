(this["webpackJsonpatko-mvp-frontend"]=this["webpackJsonpatko-mvp-frontend"]||[]).push([[2],{3970:function(e,a,t){},4010:function(e,a,t){"use strict";t.r(a);t(159);var n=t(93),r=t.n(n),c=(t(150),t(71)),o=t.n(c),i=(t(204),t(52)),s=t.n(i),l=t(1),m=t.n(l),u=t(6),d=t(8),p=(t(151),t(66)),y=t.n(p),g=(t(149),t(69)),b=t.n(g),k=t(0),f=t.n(k),E=t(28),v=t(10),w=t(42),N=t(3870),h=(t(3970),t(11),b.a.Text),x=[{name:"Hotels",key:"hotels",marginKey:"hotelMargin",path:"/img/QueryIcons/newProductIcons/hotel.svg"},{name:"Activities",key:"activities",marginKey:"activityMargin",path:"/img/QueryIcons/newProductIcons/activities.svg"},{name:"Monuments",key:"monuments",marginKey:"monumentMargin",path:"/img/QueryIcons/newProductIcons/monuments.svg"},{name:"Transport",key:"transports",marginKey:"transportMargin",path:"/img/QueryIcons/newProductIcons/transport.svg"},{name:"Local Guides",key:"localGuideServices",marginKey:"guideServiceMargin",path:"/img/QueryIcons/newProductIcons/guides.svg"},{name:"Accompanying Guides",key:"accompanyingGuideServices",marginKey:"guideServiceMargin",path:"/img/QueryIcons/newProductIcons/guides.svg"},{name:"Amenity Packs",key:"amenityPackage",marginKey:"amenityPackageMargin",path:"/img/QueryIcons/newProductIcons/guides.svg"},{name:"Meet & Greet",key:"meetAndGreets",marginKey:"meetAndGreetMargin",path:"/img/QueryIcons/newProductIcons/guides.svg"},{name:"Food & Beverages",key:"foodAndBeverages",marginKey:"foodAndBeveragesMargin",path:"/img/QueryIcons/newProductIcons/fb-services.svg"}],I={"margin-bottom":"5px 7px 2px 154px","border-radius":"13px","font-size":"12px","margin-right":"10px",border:"solid 1px #ffffff"};var B=Object(E.b)((function(e){var a=e.Queries,t=e.QueryDetails;return{queryId:a.root.queryId,priceBreakdown:a.root.priceBreakdown,role:t.role,basicInformation:t.basicInformation}}),(function(e){return{updateTaxAndMargin:Object(v.b)(w.B,e),getPriceBreakdown:Object(v.b)(w.e,e)}}))((function(e){var a,t,n=y.a.Option,c=Object(k.useState)(localStorage.getItem("email")),i=Object(d.a)(c,1)[0],l=Object(k.useState)(!1),p=Object(d.a)(l,2),g=p[0],b=p[1],E=Object(k.useState)(0),v=Object(d.a)(E,2),w=v[0],B=v[1],j=Object(k.useState)({}),C=Object(d.a)(j,2),O=(C[0],C[1],Object(k.useState)({})),M=Object(d.a)(O,2),A=M[0],K=M[1],P=Object(k.useState)(0),Q=Object(d.a)(P,2),S=Q[0],F=Q[1],T=Object(k.useState)(1),G=Object(d.a)(T,2),q=G[0],R=G[1],L=Object(k.useState)(0),J=Object(d.a)(L,2),z=J[0],D=J[1],H=Object(k.useState)(0),V=Object(d.a)(H,2),Y=(V[0],V[1],Object(k.useState)(-1)),$=Object(d.a)(Y,2),U=$[0],W=$[1],X=function(){var e=Object(u.a)(m.a.mark((function e(a,t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:K(a),F(t),R(t),b(!0);case 4:case"end":return e.stop()}}),e)})));return function(a,t){return e.apply(this,arguments)}}(),Z=function(){var a=Object(u.a)(m.a.mark((function a(){var t,n,r;return m.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if("all"!==A){a.next=7;break}return t={countries:[]},e.priceBreakdown.breakdown.forEach((function(e,a){var n={};a===w&&(n.country=e.country.code,n.tax=Number(e.totalCost.tax),n.overallMargin=Number(a===w?q:e.totalCost.margin),x.forEach((function(a){null!==e[a.key]?(n["".concat(a.marginKey)]=Number(q),n["".concat(a.key)]={},e[a.key].breakdown.forEach((function(e){n["".concat(a.key)][e.id]=Number(q)}))):(n["".concat(a.marginKey)]=0,n["".concat(a.key)]={})})),t.countries.push(n))})),a.next=5,e.updateTaxAndMargin(e.queryId,t);case 5:a.next=18;break;case 7:if(-1!==U){a.next=14;break}return n={countries:[]},e.priceBreakdown.breakdown.forEach((function(e,a){if(a===w){var t={};t.country=e.country.code,t.tax=Number(e.totalCost.tax),t.overallMargin=Number(e.totalCost.margin),x.forEach((function(a){null!==e[a.key]?a.key===A?(t["".concat(a.marginKey)]=Number(q),t["".concat(a.key)]={},e[a.key].breakdown.forEach((function(e){t["".concat(a.key)][e.id]=Number(q)}))):(t["".concat(a.marginKey)]=Number(e[a.key].margin),t["".concat(a.key)]={},e[a.key].breakdown.forEach((function(e){t["".concat(a.key)][e.id]=Number(e.margin)}))):(t["".concat(a.marginKey)]=0,t["".concat(a.key)]={})})),n.countries.push(t)}})),a.next=12,e.updateTaxAndMargin(e.queryId,n);case 12:a.next=18;break;case 14:return r={countries:[]},e.priceBreakdown.breakdown.forEach((function(e,a){if(a===w){var t={};t.country=e.country.code,t.tax=Number(e.totalCost.tax),t.overallMargin=Number(e.totalCost.margin),x.forEach((function(a){null!==e[a.key]?a.key===A?(t["".concat(a.marginKey)]=Number(e[a.key].margin),t["".concat(a.key)]={},e[a.key].breakdown.forEach((function(e,n){t["".concat(a.key)][e.id]=Number(n===U?q:e.margin)}))):(t["".concat(a.marginKey)]=Number(e[a.key].margin),t["".concat(a.key)]={},e[a.key].breakdown.forEach((function(e){t["".concat(a.key)][e.id]=Number(e.margin)}))):(t["".concat(a.marginKey)]=0,t["".concat(a.key)]={})})),r.countries.push(t)}})),a.next=18,e.updateTaxAndMargin(e.queryId,r);case 18:b(!1),W(-1);case 20:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}(),_=function(){var a=Object(u.a)(m.a.mark((function a(t){var n;return m.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n={countries:[]},e.priceBreakdown.breakdown.forEach((function(e,a){if(a===w){var r={};r.country=e.country.code,r.tax=Number(a===w?t:e.totalCost.tax),r.overallMargin=Number(e.totalCost.margin),x.forEach((function(a){null!==e[a.key]?(r["".concat(a.marginKey)]=Number(e[a.key].margin),r["".concat(a.key)]={},e[a.key].breakdown.forEach((function(e){r["".concat(a.key)][e.id]=Number(e.margin)}))):(r["".concat(a.marginKey)]=0,r["".concat(a.key)]={})})),n.countries.push(r)}})),a.next=4,e.updateTaxAndMargin(e.queryId,n);case 4:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}();Object(k.useEffect)((function(){Object.keys(e.priceBreakdown).length>0&&e.priceBreakdown.totalCost.length>0&&e.priceBreakdown.breakdown.length>0&&Object.keys(e.priceBreakdown.breakdown[w].totalCost).length>0&&(console.log("here"),D(e.priceBreakdown.breakdown[w].totalCost.tax))}),[e.priceBreakdown,w]);return f.a.createElement(r.a,{className:"price-breakdown",visible:e.visible,onCancel:function(){return e.setVisible(!1)},footer:null,width:"40%",style:{top:0},bodyStyle:{height:"100vh",display:"grid",gridTemplateRows:"0.8fr 3.2fr"},closeIcon:f.a.createElement("img",{src:"/img/black-cancel-circle.svg",alt:"close"})},Object.keys(e.priceBreakdown).length>0&&e.priceBreakdown.breakdown.length>0?f.a.createElement(f.a.Fragment,null,f.a.createElement("div",{className:"modal-header"},f.a.createElement("section",{className:"options mb-20"},f.a.createElement("section",{className:"flex justify-between"},f.a.createElement(s.a.Group,{buttonStyle:"solid",value:w,onChange:function(e){B(e.target.value)}},e.priceBreakdown.breakdown.map((function(e,a){return f.a.createElement(s.a.Button,{value:a,style:I},e.country.name)}))))),f.a.createElement("section",{className:"heading"},f.a.createElement("p",{className:"text-16 bold"},"Price Breakdown"),f.a.createElement("p",{className:"text-12 mt-2 subheading"},"for ",e.itineraryName)),f.a.createElement("section",{className:"pricing mt-24"},f.a.createElement("div",null,f.a.createElement("p",{className:"price"},Object.keys(e.priceBreakdown).length>0&&e.priceBreakdown.breakdown[w].totalCost.baseCost.length>0?e.priceBreakdown.breakdown[w].totalCost.baseCost.map((function(e){return"".concat(e.currency.symbol?e.currency.symbol:e.currency.code," ").concat(Number(e.amount).toFixed(2))})).join(" + "):Number(0).toFixed(2)),f.a.createElement("p",{className:"desc"},"base price/person")),f.a.createElement("div",{className:"symbol"},"+"),f.a.createElement("div",null,f.a.createElement("section",{className:"flex items-center"},f.a.createElement("p",{className:"price mr-6"},e.priceBreakdown.breakdown[w].totalCost.margin,"%"),f.a.createElement("input",{type:"image",className:"btnImage mr-6 ".concat((null===(a=e.basicInformation)||void 0===a?void 0:a.assignedToEmail)!==i?"opacity-20":""),src:"/img/QueryIcons/edit-blue.svg",alt:"edit",onClick:function(){return X("all",e.priceBreakdown.breakdown[w].totalCost.margin)}}),f.a.createElement("img",{className:"mr-10 opacity-20",src:"/img/QueryIcons/high.svg"})),f.a.createElement("p",{className:"desc opacity-20"},"overall margin")),f.a.createElement("div",{className:"symbol"},"+"),f.a.createElement("div",{className:"tax-selector"},f.a.createElement(y.a,{disabled:(null===(t=e.basicInformation)||void 0===t?void 0:t.assignedToEmail)!==i,value:z,onChange:_,suffixIcon:f.a.createElement(N.a,{style:{color:"#fff"}})},f.a.createElement(n,{value:"0"},"0%"),f.a.createElement(n,{value:"0.90"},"0.90%"),f.a.createElement(n,{value:"1.80"},"1.80%"),f.a.createElement(n,{value:"5"},"5%"),f.a.createElement(n,{value:"18"},"18%")),f.a.createElement("p",{className:"desc mt-5"},"total taxes/person"))),f.a.createElement("hr",{className:"divider mr-30 mt-16 mb-16"}),f.a.createElement("section",{className:"total mb-20"},f.a.createElement("div",null,f.a.createElement("section",{className:"flex items-center"},f.a.createElement("img",{className:"mr-10",src:"/img/QueryIcons/register.svg"}),f.a.createElement("p",{className:"price"},"Total cost")),f.a.createElement("p",{className:"desc"},"per person")),f.a.createElement("div",{className:"down"},f.a.createElement("p",{className:"price mr-30"},Object.keys(e.priceBreakdown).length>0&&e.priceBreakdown.breakdown[w].totalCost.totalCost.length>0?e.priceBreakdown.breakdown[w].totalCost.totalCost.map((function(e){return"".concat(e.currency.symbol?e.currency.symbol:e.currency.code," ").concat(Number(e.amount).toFixed(2))})).join(" & "):Number(0).toFixed(2))))),f.a.createElement("div",{className:"modal-content"},x.map((function(a){var t;return f.a.createElement(f.a.Fragment,null,Object.keys(e.priceBreakdown).length>0&&null!==e.priceBreakdown.breakdown[w][a.key]&&Object.keys(e.priceBreakdown.breakdown[w][a.key]).length>0&&e.priceBreakdown.breakdown[w][a.key].breakdown.length>0&&f.a.createElement(f.a.Fragment,null,f.a.createElement("section",{className:"product-head flex items-center"},f.a.createElement("img",{className:"mr-10",src:a.path}),f.a.createElement("p",{className:"bold text-14 mr-24"},a.name),f.a.createElement("p",{className:"mr-4"},"Margin:"),f.a.createElement("p",{className:"bold mr-6"},e.priceBreakdown.breakdown[w][a.key].margin,"%"),f.a.createElement("input",{type:"image",className:"btnImage mr-6 ".concat((null===(t=e.basicInformation)||void 0===t?void 0:t.assignedToEmail)!==i?"opacity-20":""),src:"/img/QueryIcons/edit-blue.svg",alt:"edit",onClick:function(){return X(a.key,e.priceBreakdown.breakdown[w][a.key].margin)}}),f.a.createElement("p",{className:"bold price text-14"},e.priceBreakdown.breakdown[w][a.key].totalCost.map((function(e){return"".concat(e.currency.symbol?e.currency.symbol:e.currency.code," ").concat(Number(e.amount).toFixed(2))})).join(" & "))),f.a.createElement("section",{className:"product-detail"},e.priceBreakdown.breakdown[w][a.key].breakdown.length>0&&f.a.createElement(f.a.Fragment,null,f.a.createElement("div",{class:"row"},f.a.createElement("div",{className:"grid-header"},f.a.createElement("span",null,"NAME"),f.a.createElement("span",null,"PRICE (inc. of all taxes)"),f.a.createElement("span",null,"MARGIN"),f.a.createElement("span",null,"FINAL PRICE")),f.a.createElement("div",{className:"grid-content"},e.priceBreakdown.breakdown[w][a.key].breakdown.map((function(t,n){var r,c;return f.a.createElement(f.a.Fragment,null,f.a.createElement("div",{class:"column1 content-data"},f.a.createElement("div",{className:"product-row name"},f.a.createElement("p",{className:"product"},null===t||void 0===t?void 0:t.name),f.a.createElement("p",{className:"location"},null===t||void 0===t||null===(r=t.city)||void 0===r?void 0:r.name))),f.a.createElement("div",{class:"column2 content-data"},f.a.createElement("div",{className:"product-row"},f.a.createElement("p",{className:"product"},"".concat(t.currency.symbol?t.currency.symbol:t.currency.code," ").concat(Number(t.perPersonCost).toFixed(2))))),f.a.createElement("div",{class:"column3 content-data"},f.a.createElement("div",{className:"product-row product-margin flex items-center"},f.a.createElement("p",{className:"mr-6"}," ","+ ",t.margin,"%"),f.a.createElement("input",{type:"image",className:"btnImage mr-6 ".concat((null===(c=e.basicInformation)||void 0===c?void 0:c.assignedToEmail)!==i?"opacity-20":""),src:"/img/QueryIcons/edit-blue.svg",alt:"edit",onClick:function(){K(a.key),W(n),X(a.key,t.margin)}}))),f.a.createElement("div",{class:"column4 content-data"},f.a.createElement("div",{className:"product-row"},f.a.createElement("p",{className:"product"},"".concat(t.currency.symbol?t.currency.symbol:t.currency.code," ").concat(Number(t.totalCost).toFixed(2))))))}))))))))})),f.a.createElement(r.a,{className:"edit-margin",width:"400px",centered:!0,key:S,footer:null,visible:g,onCancel:function(){return b(!1)},closeIcon:f.a.createElement("img",{src:"/img/black-cancel-circle.svg",alt:"close"})},f.a.createElement("section",{className:"edit-heading"},f.a.createElement("p",{className:"title bold mb-6"},"Add Margin"),f.a.createElement("p",{className:"subtitle"},"Applies on all the products, but can be overridden at product level or individual item level.")),f.a.createElement("section",{className:"edit-content mt-26"},f.a.createElement("p",{className:"title"},"MARGIN %AGE"),f.a.createElement(o.a,{className:"mt-6",value:q,onChange:function(e){return function(e){var a=e.target.value;!isNaN(a)&&/^-?\d*(\.\d*)?$/.test(a)&&"-"!==a&&a<=100&&"0000"!==a&&"000"!==a&&"00"!==a&&R(a)}(e)},maxLength:5})),f.a.createElement("button",{className:"editBtn mt-26",onClick:function(){return Z()}},"Apply")))):f.a.createElement("div",{className:"proposal-cost no-price flex flex-col justify-center items-center p-20"},f.a.createElement("img",{src:"/img/QueryIcons/proposal-cost-icon.svg"}),f.a.createElement(h,{className:"bold text-18 mt-6"},"Price Breakdown"),f.a.createElement(h,{className:"text-14 mt-6",style:{textAlign:"center"}},"You\u2019ll see a breakdown of price here, once you add products.")))}));a.default=B}}]);