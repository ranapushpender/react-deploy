(this["webpackJsonpatko-mvp-frontend"]=this["webpackJsonpatko-mvp-frontend"]||[]).push([[10],{3889:function(e,a,t){},3890:function(e,a,t){},3891:function(e,a,t){},3892:function(e,a,t){},3893:function(e,a,t){},3894:function(e,a,t){},3995:function(e,a,t){"use strict";t.r(a);var n=t(2),c=t(8),i=t(0),l=t.n(i),o=t(28),r=t(57),s=t(10),u=t(47),d=t(27),m=t(210),b=t(166),v=t(11),g=t(211),p=t(250),f=(t(159),t(93)),y=t.n(f),O=(t(38),t(21)),j=t.n(O),h=(t(180),t(104)),E=t.n(h),S=(t(76),t(44)),C=t.n(S),x=(t(86),t(34)),N=t.n(x),k=t(19),P=t(18),w=t(1),_=t.n(w),L=t(6),A=(t(284),t(129)),D=t.n(A),R=(t(149),t(69)),T=t.n(R),I=(t(140),t(63)),F=t.n(I),z=t(83),V=t.n(z),q=t(13),B=t(74),U=t(477),G=t(142),M=t(22),K=(t(3889),function(e,a){var t=e._selectedCities.map((function(a){return{allCities:!1,city:null===a||void 0===a?void 0:a.value,amCharge:+e.standardRates["amCharge-".concat(a.key,"-").concat(a.label)],pmCharge:+e.standardRates["pmCharge-".concat(a.key,"-").concat(a.label)]}}));return a&&t.push({allCities:!0,city:"",amCharge:+e.standardRates["amCharge-pan"],pmCharge:+e.standardRates["pmCharge-pan"]}),t}),W=F.a.TabPane;T.a.Text,T.a.Link,T.a.Title,D.a.Column,D.a.ColumnGroup;var J=Object(o.b)((function(e,a){var t,n,c,i,l,o,r,s,u=e.Products.guide,d=u.contract,m=u.basicDetails;return{contract:d,currencySymbol:(null===d||void 0===d||null===(t=d.contractDetails)||void 0===t||null===(n=t.data)||void 0===n||null===(c=n.currency)||void 0===c?void 0:c.symbol)||"",isConveyanceSurchargeSaved:null===d||void 0===d||null===(i=d.localConveyancePrices)||void 0===i?void 0:i.isDataSaved,contractName:null===m||void 0===m||null===(l=m.data)||void 0===l?void 0:l.name,tabStatus:u.tabStatus.status,cities:null===(o=m.data)||void 0===o?void 0:o.location.cities,isPanIndia:!!(null===(r=m.data)||void 0===r||null===(s=r.location)||void 0===s?void 0:s.isPANCountry)}}),(function(e){return{getCityListNoParams:Object(s.b)(G.b,e),updateRateCardPricing:Object(s.b)(b.w,e)}}))((function(e){var a,t=Object(r.i)(),o=t.id,s=(t.productType,Object(i.useState)({defaultLanguage:"",_selectedCities:[],_selectedSlabs:[],standardRates:{}})),u=Object(c.a)(s,2),d=u[0],m=u[1],b=(e.rateCardIndexToEdit,Object(i.useState)(!1)),g=Object(c.a)(b,2),p=g[0],f=g[1],O=Object(i.useState)(""),h=Object(c.a)(O,2),S=(h[0],h[1],Object(i.useState)([])),x=Object(c.a)(S,2),w=(x[0],x[1]),A=(Object(v.d)(Object(L.a)(_.a.mark((function e(){var a,t,n,c=arguments;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=c.length>0&&void 0!==c[0]?c[0]:"",e.next=3,U.a.getLanguageList(a);case 3:t=e.sent,n=t.data,w((null===n||void 0===n?void 0:n.content)||[]);case 6:case"end":return e.stop()}}),e)}))),300),Object(v.d)(Object(L.a)(_.a.mark((function a(){var t,n,c=arguments;return _.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return t=c.length>0&&void 0!==c[0]?c[0]:"",a.next=3,e.getCityListNoParams(t);case 3:n=a.sent,T((null===n||void 0===n?void 0:n.content)||[]);case 5:case"end":return a.stop()}}),a)}))),300),Object(i.useState)([])),R=Object(c.a)(A,2),T=(R[0],R[1]);Object(i.useEffect)((function(){var a={},t=Object(v.g)(e.contract,"localStandardPrices.data.price",[]),c=Object(v.g)(e.contract,"localConveyancePrices.data",[]);t.map((function(e){var t=e.city;t&&(a[null===t||void 0===t?void 0:t.code]=t)}));var i={};(null===c||void 0===c?void 0:c.length)>0&&c.forEach((function(e){var a,t,n,c;e.allCities?(i["amCharge-pan"]=+e.amCharge,i["pmCharge-pan"]=+e.pmCharge):(i["amCharge-".concat(null===e||void 0===e||null===(a=e.city)||void 0===a?void 0:a.code,"-").concat(null===e||void 0===e||null===(t=e.city)||void 0===t?void 0:t.name)]=+e.amCharge,i["pmCharge-".concat(null===e||void 0===e||null===(n=e.city)||void 0===n?void 0:n.code,"-").concat(null===e||void 0===e||null===(c=e.city)||void 0===c?void 0:c.name)]=+e.pmCharge)})),T(B.Object.entries(a).map((function(e){return e[1]}))),m(Object(n.a)(Object(n.a)({},d),{},{_selectedCities:B.Object.entries(a).map((function(e){return{label:e[1].name,value:e[1].code,key:e[1].code}})),_selectedSlabs:["amCharge","pmCharge"],standardRates:i})),I(),z()}),[e.contract]);var I=function(a){var t=d._selectedCities.reduce((function(a,t){var c=d._selectedSlabs.reduce((function(a,c){var i="".concat(c),l="".concat(i,"-").concat(t.key,"-").concat(t.label);return Object(n.a)(Object(n.a)({},a),{},Object(P.a)({},i,"".concat(d.standardRates[l]?e.currencySymbol+d.standardRates[l]:"--")))}),{});return c=Object(n.a)(Object(n.a)({},c),{},{city:l.a.createElement("span",{className:"semibold"},t.label)}),[].concat(Object(k.a)(a),[c])}),[]);if(e.isPanIndia){var c=d._selectedSlabs.reduce((function(a,t){var c="".concat(t),i="".concat(c,"-pan");return Object(n.a)(Object(n.a)({},a),{},Object(P.a)({},c,"".concat(d.standardRates[i]?e.currencySymbol+d.standardRates[i]:"--")))}),{});t=[c=Object(n.a)(Object(n.a)({},c),{},{city:l.a.createElement("span",{className:"semibold"},"PAN")})].concat(Object(k.a)(t))}return t},z=function(){var e=[{title:"Start time before 07:30hrs",dataIndex:"amCharge",key:"amCharge"},{title:"End time after 20:30hrs",dataIndex:"pmCharge",key:"pmCharge"}];return e.unshift({title:"City",dataIndex:"city",key:"city"}),e},G=function(e){return"amCharge"===e?"Start time before 07:30hrs":"pmCharge"===e?"End time after 20:30hrs":null===e||void 0===e?void 0:e.split("_").join(" ")},J=function(e){var a=[{title:"City",dataIndex:"city",key:"city"}];return a=[].concat(Object(k.a)(a),Object(k.a)(e._selectedSlabs.map((function(e,a){return{title:G(e),dataIndex:"".concat(e),key:"".concat(e)}}))))},H=function(a){var t=[];return e.isPanIndia&&(t=[].concat(Object(k.a)(t),[Object(n.a)({city:"PAN India"},a._selectedSlabs.reduce((function(t,c,i){var o=(e.isDurationTypeAccompanying,"".concat(c)),r=(e.isDurationTypeAccompanying,"".concat(c,"-pan"));return Object(n.a)(Object(n.a)({},t),{},Object(P.a)({},o,l.a.createElement(q.b,{component:M.b,name:"standardRates.".concat(r),value:Object(v.g)(a,"standardRates.".concat(r),""),label:"Price",type:"number",min:"0",required:!0,step:"any"})))}),{}))])),a._selectedCities.forEach((function(e,c){t=[].concat(Object(k.a)(t),[Object(n.a)({city:"".concat(e.label)},a._selectedSlabs.reduce((function(t,c,i){var o="".concat(c);return Object(n.a)(Object(n.a)({},t),{},Object(P.a)({},o,l.a.createElement(q.b,{component:M.b,name:"standardRates[".concat(c,"-").concat(e.key,"-").concat(e.label,"]"),value:Object(v.g)(a,"standardRates.".concat(c,"-").concat(e.key,"-").concat(e.label),""),label:"Price",required:!0,type:"number",min:"0",step:"any"})))}),{}))])})),t},Q=Object(i.useState)("conveyance-surcharge-pricing"),X=Object(c.a)(Q,2),Y=X[0],Z=X[1],$=!!(null===(a=e.loader)||void 0===a?void 0:a.isFetching);return l.a.createElement("div",null,l.a.createElement(C.a,{type:"inner",className:"mt-40",title:l.a.createElement("div",{className:"flex flex-col"},l.a.createElement("p",null,"Conveyance Surcharge *"," ",e.isConveyanceSurchargeSaved?v.k:l.a.createElement(V.a,{className:"ml-10",twoToneColor:"#ea9300"})),l.a.createElement("p",{className:"mt-6 text-12 light"},"Surcharge for availing the service at odd times")),extra:l.a.createElement(l.a.Fragment,null,Object(v.m)(e.tabStatus)?l.a.createElement("div",null):l.a.createElement(l.a.Fragment,null,Object(v.g)(e.contract,"localStandardPrices.isDataSaved")?l.a.createElement("div",{onClick:function(){return f(!0)},className:"flex items-center cursor-pointer"},l.a.createElement("img",{src:"/img/edit-blue.svg"}),l.a.createElement("p",{className:"ml-10"},"Edit")):l.a.createElement("p",null,"Please fill Pricing Tab Data in order to update this")))},$?l.a.createElement(N.a,{active:!0}):l.a.createElement("div",null,l.a.createElement(D.a,{pagination:!1,columns:z(),dataSource:I()}))),l.a.createElement(y.a,{visible:p,keyboard:!1,footer:null,destroyOnClose:!0,width:"664px",className:"conveyance-surcharge-modal",closeIcon:l.a.createElement("img",{onClick:function(){return f(!1)},alt:"close",src:"/img/black-cancel-circle.svg"})},l.a.createElement("div",{id:"conveyance-surcharge-modal"},l.a.createElement(q.e,{enableReinitialize:!0,initialValues:d,onSubmit:function(){var a=Object(L.a)(_.a.mark((function a(t,n){var c;return _.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n.setSubmitting,c=K(t,e.isPanIndia),a.next=4,e.updateRateCardPricing(o,e.contractId,c);case 4:f(!1);case 5:case"end":return a.stop()}}),a)})));return function(e,t){return a.apply(this,arguments)}}()},(function(a){a.setFieldValue;var t=a.isSubmitting,n=a.values;return l.a.createElement(l.a.Fragment,null,l.a.createElement("p",{className:"capitalize bold text-26"},"Update Conveyance Surcharge"),l.a.createElement("p",{className:"capitalize bold text-16 light"},e.contractName||"--"),l.a.createElement(E.a,null),l.a.createElement(q.d,null,l.a.createElement(F.a,{activeKey:Y,onChange:function(e){return Z(e)},className:"mt-20 tabs-dark"},l.a.createElement(W,{tab:l.a.createElement("div",{className:"flex justify-between items-center"},l.a.createElement("p",null,"Pricing")),key:"conveyance-surcharge-pricing"},l.a.createElement(D.a,{pagination:!1,columns:J(n),dataSource:H(n)}),l.a.createElement("div",{className:"mt-30 flex justify-flex-start"},l.a.createElement(j.a,{loading:t,type:"primary",htmlType:"submit"},t?"Updating...":"Update Conveyance Surcharge"))))))})))))})),H=(t(150),t(71)),Q=t.n(H),X=(t(3890),function(e){var a=e.values,t=e.errors,n=e.fieldName,c=e.defaultSlabs,i=e.className,o=e.setFieldValue,r=e.validateForm,s=e.selectedSlabs;return l.a.createElement("div",null,s.map((function(e,s){return l.a.createElement("div",{key:s,className:"mb-12"},l.a.createElement("div",{className:"flex items-center"},l.a.createElement("div",{className:"slab-range-picker ".concat(i)},l.a.createElement("div",{className:"flex items-center container justify-between"},l.a.createElement("p",{className:"text-16 inter-medium"},"Slab ".concat(s+1)),l.a.createElement("div",{className:"input-boxs flex items-center"},l.a.createElement(q.b,{component:Q.a,name:"".concat(n,".").concat(s,".0"),disabled:!0,value:Object(v.g)(a,"".concat(n,".").concat(s,".0"),""),onChange:function(e){o("".concat(n,"[").concat(s,"].0"),e.target.value)},type:"number",required:!0,placeholder:"min"}),l.a.createElement("div",{className:"flex items-center right-arrow justify-center"},l.a.createElement("img",{className:"cursor-pointer",src:"/img/right-arrow-theme.svg"})),l.a.createElement(q.b,{component:Q.a,disabled:s<a[n].length-1,name:"".concat(n,".").concat(s,".1"),value:Object(v.g)(a,"".concat(n,".").concat(s,".1"),""),onChange:function(e){o("".concat(n,"[").concat(s,"].1"),e.target.value).then((function(){return r()}))},type:"number",required:!0,placeholder:"max",validate:function(e){return function(e,a,t,n){var c=a.length,i="";return e?n===c-1&&+e>+t.max?i="Max range of this slab(".concat(+e,") cannot be greater than max allowed guests(").concat(+t.max,")"):+e<+a[n][0]?i="Max range of this slab(".concat(+e,") cannot be lesser than Min range of this slab(").concat(+a[n][0],")"):n===c-1&&+e<+t.max&&(i="Max range of this slab(".concat(+e,") should match the max allowed guests(").concat(+t.max,"), or try adding another slab")):i="Max slab range is required",i}(e,a._selectedSlabs,c,s)}}))),l.a.createElement("p",{className:"ml-4 mt-6 text-12 text-red"},Object(v.g)(t,"".concat(n,".").concat(s,".0"),"")),l.a.createElement("p",{className:"ml-4 mt-6 text-12 text-red"},Object(v.g)(t,"".concat(n,".").concat(s,".1"),""))),0!==s&&s+1===a[n].length?l.a.createElement("img",{src:"/img/trash-blue.svg",onClick:function(){var e=a[n].filter((function(e,a){return a!==s}));o("_selectedSlabs",e).then((function(){return r()}))},className:"cursor-pointer ml-10"}):l.a.createElement("div",{class:"ml-20"})))})),l.a.createElement("div",{onClick:function(){o("_selectedSlabs",[].concat(Object(k.a)(a[n]),[[+a[n][a[n].length-1][1]+1,+c.max]])).then((function(){return r()}))},className:"line-block ".concat(+a[n][a[n].length-1][0]>+a[n][a[n].length-1][1]||+a[n][a[n].length-1][1]>=+c.max?"read-only-mode":"")},l.a.createElement("div",{className:"cursor-pointer mt-12 flex items-center text-14 bold capitalize"},l.a.createElement("img",{className:"mr-10",src:"/img/plus.svg"}),l.a.createElement("p",null,"Add Another Slab"))))}),Y=function(e,a){var t,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return(t=e?[{title:"With Accommodation",dataIndex:"with_accommodation",key:"with_accommodation"},{title:"Without Accommodation",dataIndex:"without_accommodation",key:"without_accommodation"}]:a._selectedSlabs.map((function(e,a){var t="".concat(e[0],"-").concat(e[1]);return{title:"Slab ".concat(a+1," (").concat(e[0],"-").concat(e[1]," guests)"),dataIndex:t,key:t}}))).unshift({title:n,dataIndex:"city",key:"city"}),t},Z=(t(3891),function(e,a,t){var c=e._selectedLanguages.map((function(a){return e._selectedSlabs.reduce((function(t,n){var c="".concat(n[0],"-").concat(n[1]),i="".concat(c,"-").concat(a.key,"-").concat(a.label),l={language:null===a||void 0===a?void 0:a.value,charge:+e.standardRates[i],slab:{min:+n[0],max:+n[1]}};return[].concat(Object(k.a)(t),[l])}),[])}));if(c=c.flat(),a&&t){var i=e._selectedSlabs.reduce((function(a,t){var n="".concat(t[0],"-").concat(t[1]),c="".concat(n,"-pan"),i={language:"",charge:+e.standardRates[c],slab:{min:+t[0],max:+t[1]}};return[].concat(Object(k.a)(a),[i])}),[]);c=[].concat(Object(k.a)(c),Object(k.a)(i))}var l=c,o=l.reduce((function(e,a){var t="".concat(a.slab.min,"-").concat(a.slab.max);return e=e.hasOwnProperty(t)?Object(n.a)(Object(n.a)({},e),{},Object(P.a)({},t,{rates:[].concat(Object(k.a)(e[t].rates),[{charge:a.charge,language:a.language}])})):Object(n.a)(Object(n.a)({},e),{},Object(P.a)({},t,{rates:[{charge:a.charge,language:a.language}]}))}),{});return{slabs:Object.entries(o).map((function(e){var a=e[0].split("-");return{min:a[0],max:a[1],rates:e[1].rates}})),languages:Array.from(new Set(l.filter((function(e){return!!e.language})).map((function(e){return e.language}))))}}),$=function(e,a){return Object.entries(e.standardRates).map((function(e){return{language:e[0],rates:e[1].rates.map((function(e){return{withAccommodationCharge:e.withAccommodationCharge,withoutAccommodationCharge:e.withoutAccommodationCharge,city:e.city?e.city.code:null,isPANCountry:e.allCities}}))}}))},ee=F.a.TabPane;T.a.Text,T.a.Link,T.a.Title,D.a.Column,D.a.ColumnGroup;var ae=Object(o.b)((function(e,a){var t,n,c,i,l,o,r,s,u,d,m,b,v,g,p,f,y=e.Products.guide,O=y.contract,j=y.basicDetails;return b="accompanying"===(null===(t=j.data)||void 0===t?void 0:t.type)?null===(v=O.accompanyingPrices)||void 0===v||null===(g=v.data)||void 0===g||null===(p=g.find((function(e){return e.isDefaultLanguage})))||void 0===p?void 0:p.language:null===(f=O.localStandardPrices.data)||void 0===f?void 0:f.defaultLanguage,{contract:O,currencySymbol:(null===O||void 0===O||null===(n=O.contractDetails)||void 0===n||null===(c=n.data)||void 0===c||null===(i=c.currency)||void 0===i?void 0:i.symbol)||"",defaultPricingLanguage:b,isLanguagePricesSaved:null===O||void 0===O||null===(l=O.localLanguagePrices)||void 0===l?void 0:l.isDataSaved,contractName:null===j||void 0===j||null===(o=j.data)||void 0===o?void 0:o.name,tabStatus:y.tabStatus.status,defaultSlabs:(null===(r=j.data)||void 0===r?void 0:r.audience)||[],cities:(null===(s=j.data)||void 0===s?void 0:s.location.cities)||[],isDurationTypeAccompanying:!("accompanying"!=(null===(u=j.data)||void 0===u?void 0:u.type)),isPanIndia:!!(null===(d=j.data)||void 0===d||null===(m=d.location)||void 0===m?void 0:m.isPANCountry)}}),(function(e){return{getCityListNoParams:Object(s.b)(G.b,e),updateAccompanyingLanguagePrices:Object(s.b)(b.s,e),updateLocalLanguagePrices:Object(s.b)(b.x,e)}}))((function(e){var a,t=Object(r.i)(),o=t.id,s=(t.productType,Object(i.useState)({_selectedLanguages:[],_selectedSlabs:[],standardRates:{}})),u=Object(c.a)(s,2),d=u[0],m=u[1],b=(e.rateCardIndexToEdit,Object(i.useState)(!1)),g=Object(c.a)(b,2),p=g[0],f=g[1],O=Object(i.useState)(""),h=Object(c.a)(O,2),S=(h[0],h[1],Object(i.useState)([])),x=Object(c.a)(S,2),w=x[0],A=x[1],R=Object(i.useState)([]),T=Object(c.a)(R,2),I=T[0],z=T[1],V=Object(v.d)(Object(L.a)(_.a.mark((function e(){var a,t,n,c=arguments;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=c.length>0&&void 0!==c[0]?c[0]:"",e.next=3,U.a.getLanguageList(a);case 3:t=e.sent,n=t.data,A((null===n||void 0===n?void 0:n.content)||[]);case 6:case"end":return e.stop()}}),e)}))),300),G=Object(v.d)(Object(L.a)(_.a.mark((function a(){var t,n,c=arguments;return _.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return t=c.length>0&&void 0!==c[0]?c[0]:"",a.next=3,e.getCityListNoParams(t);case 3:n=a.sent,J((null===n||void 0===n?void 0:n.content)||[]);case 5:case"end":return a.stop()}}),a)}))),300),K=Object(i.useState)([]),W=Object(c.a)(K,2),J=(W[0],W[1]);Object(i.useEffect)((function(){var a,t,c={};e.isDurationTypeAccompanying?a=Object(v.g)(e.contract,"accompanyingPrices.data",[]):(a=Object(v.g)(e.contract,"localLanguagePrices.data",[])).map((function(e){var a=e.language;a&&(c[null===a||void 0===a?void 0:a.code]=a)}));var i={};if(e.isDurationTypeAccompanying){var l;z(null===(l=a.find((function(e){return!0===(null===e||void 0===e?void 0:e.isDefaultLanguage)})))||void 0===l?void 0:l.rates.map((function(e){return Object(n.a)(Object(n.a)({},e),{},{isDefaultLanguage:!1,withAccommodationCharge:"",withoutAccommodationCharge:""})}))),t=["with_accommodation","without_accommodation"],a.filter((function(e){return!1===(null===e||void 0===e?void 0:e.isDefaultLanguage)})).map((function(e,a){var t,n;c[null===(t=e.language)||void 0===t?void 0:t.code]=e.language,i["".concat(null===(n=e.language)||void 0===n?void 0:n.code)]=e}))}else{var o,r;if(t={},a.map((function(e,a){var n,c,i,l;t["".concat(null===(n=e.slab)||void 0===n?void 0:n.min,"-").concat(null===(c=e.slab)||void 0===c?void 0:c.max)]={min:null===(i=e.slab)||void 0===i?void 0:i.min,max:null===(l=e.slab)||void 0===l?void 0:l.max}})),0===B.Object.keys(t).length)t=Object(P.a)({},"".concat(null===(o=e.defaultSlabs)||void 0===o?void 0:o.min,"-").concat(null===(r=e.defaultSlabs)||void 0===r?void 0:r.max),e.defaultSlabs);t=B.Object.keys(t).map((function(e){return null===e||void 0===e?void 0:e.split("-")})).sort((function(e,a){return+e[0]-+a[0]})),a.map((function(e){var a,t,n,c,l,o,r=e.language?"".concat(null===e||void 0===e||null===(a=e.slab)||void 0===a?void 0:a.min,"-").concat(null===e||void 0===e||null===(t=e.slab)||void 0===t?void 0:t.max,"-").concat(null===e||void 0===e||null===(n=e.language)||void 0===n?void 0:n.code,"-").concat(null===e||void 0===e||null===(c=e.language)||void 0===c?void 0:c.name):"".concat(null===e||void 0===e||null===(l=e.slab)||void 0===l?void 0:l.min,"-").concat(null===e||void 0===e||null===(o=e.slab)||void 0===o?void 0:o.max,"-pan");i[r]=e.charge})),B.Object.keys(t).map((function(a){e.cities.map((function(e){var a,t,n,c,l,o,r=e.city?"".concat(null===e||void 0===e||null===(a=e.slab)||void 0===a?void 0:a.min,"-").concat(null===e||void 0===e||null===(t=e.slab)||void 0===t?void 0:t.max,"-").concat(null===e||void 0===e||null===(n=e.city)||void 0===n?void 0:n.code,"-").concat(null===e||void 0===e||null===(c=e.city)||void 0===c?void 0:c.name):"".concat(null===e||void 0===e||null===(l=e.slab)||void 0===l?void 0:l.min,"-").concat(null===e||void 0===e||null===(o=e.slab)||void 0===o?void 0:o.max,"-pan");i[r]=e.charge}))}))}J(B.Object.entries(c).map((function(e){return e[1]}))),m(Object(n.a)(Object(n.a)({},d),{},{_selectedLanguages:B.Object.entries(c).map((function(e){return{label:e[1].name,value:e[1].code,key:e[1].code}})),_selectedSlabs:t,standardRates:i}))}),[e.contract]),Object(i.useEffect)((function(){G(),V()}),[]);var H=function(a){var t=d._selectedLanguages.reduce((function(a,t){var c=d._selectedSlabs.reduce((function(a,c){var i=e.isDurationTypeAccompanying?"".concat(c):"".concat(c[0],"-").concat(c[1]),l="".concat(i,"-").concat(t.key,"-").concat(t.label);return Object(n.a)(Object(n.a)({},a),{},Object(P.a)({},i,"".concat(e.currencySymbol," ").concat(d.standardRates[l])))}),{});return c=Object(n.a)(Object(n.a)({},c),{},{city:l.a.createElement("span",{className:"semibold"},t.label)}),[].concat(Object(k.a)(a),[c])}),[]);if(e.isPanIndia&&e.isDurationTypeAccompanying){var c=d._selectedSlabs.reduce((function(a,t){var c=e.isDurationTypeAccompanying?"".concat(t):"".concat(t[0],"-").concat(t[1]),i="".concat(c,"-pan");return Object(n.a)(Object(n.a)({},a),{},Object(P.a)({},c,"".concat(e.currencySymbol," ").concat(d.standardRates[i])))}),{});t=[c=Object(n.a)(Object(n.a)({},c),{},{city:l.a.createElement("span",{className:"semibold"},"PAN")})].concat(Object(k.a)(t))}return t},Q=Object(i.useState)("product-guide-breakdown"),ae=Object(c.a)(Q,2),te=ae[0],ne=ae[1],ce=Object(i.useState)(),ie=Object(c.a)(ce,2),le=ie[0],oe=ie[1],re=!!(null===(a=e.loader)||void 0===a?void 0:a.isFetching),se=function(a){var t=[{title:"City",dataIndex:"city",key:"city"}];return t=e.isDurationTypeAccompanying?[].concat(Object(k.a)(t),Object(k.a)(a._selectedSlabs.map((function(e,a){return{title:null===e||void 0===e?void 0:e.split("_").join(" "),dataIndex:e,key:e}})))):[].concat(Object(k.a)(t),Object(k.a)(a._selectedSlabs.map((function(e,a){return{title:"Slab ".concat(a+1," (").concat(e[0],"-").concat(e[1]," guests)"),dataIndex:"".concat(e[0],"-").concat(e[1]),key:"".concat(e[0],"-").concat(e[1])}}))))},ue=function(a){var t=[];return e.isPanIndia&&e.isDurationTypeAccompanying&&(t=[].concat(Object(k.a)(t),[Object(n.a)({city:"PAN India"},a._selectedSlabs.reduce((function(t,c,i){var o=e.isDurationTypeAccompanying?"".concat(c):"".concat(c[0],"-").concat(c[1]),r=e.isDurationTypeAccompanying?"".concat(c,"-pan"):"".concat(c[0],"-").concat(c[1],"-pan");return Object(n.a)(Object(n.a)({},t),{},Object(P.a)({},o,l.a.createElement(q.b,{component:M.b,name:"standardRates.".concat(r),value:Object(v.g)(a,"standardRates.".concat(r),""),type:"number",label:"Price",min:"0",required:!0,step:"any"})))}),{}))])),a._selectedLanguages.forEach((function(c,i){t=e.isDurationTypeAccompanying?[].concat(Object(k.a)(t),[Object(n.a)({city:"".concat(c.label)},a._selectedSlabs.reduce((function(e,t,i){var o="".concat(t);return Object(n.a)(Object(n.a)({},e),{},Object(P.a)({},o,l.a.createElement(q.b,{component:M.b,name:"standardRates[".concat(t,"-").concat(c.key,"-").concat(c.label,"]"),value:Object(v.g)(a,"standardRates.".concat(t,"-").concat(c.key,"-").concat(c.label),""),label:"Price",required:!0,min:"0",step:"any",type:"number"})))}),{}))]):[].concat(Object(k.a)(t),[Object(n.a)({city:"".concat(c.label)},a._selectedSlabs.reduce((function(e,t,i){var o="".concat(t[0],"-").concat(t[1]);return Object(n.a)(Object(n.a)({},e),{},Object(P.a)({},o,l.a.createElement(q.b,{component:M.b,name:"standardRates[".concat(t[0],"-").concat(t[1],"-").concat(c.key,"-").concat(c.label,"]"),value:Object(v.g)(a,"standardRates.".concat(t[0],"-").concat(t[1],"-").concat(c.key,"-").concat(c.label),""),label:"Price",required:!0,type:"number",min:"0",step:"any"})))}),{}))])})),t};return l.a.createElement("div",null,re?l.a.createElement(N.a,{active:!0}):e.isDurationTypeAccompanying?function(){var a,t;return l.a.createElement(C.a,{type:"inner",className:"mt-40 tabs-dark",title:l.a.createElement("div",{className:"flex flex-col"},l.a.createElement("p",null,"Language Surcharge"," ",l.a.createElement("span",{className:"text-12 light"},"(optional)"),e.isLanguagePricesSaved&&v.k),l.a.createElement("p",{className:"mt-6 text-12 light"},"Guests breakdown & surcharge over specific languages")),size:"small",extra:l.a.createElement(l.a.Fragment,null,Object(v.m)(e.tabStatus)?l.a.createElement("div",null):l.a.createElement(l.a.Fragment,null,0===(null===(a=Object(v.g)(e.contract,"accompanyingPrices.data",[]))||void 0===a?void 0:a.length)?l.a.createElement("p",null,"Please fill Pricing Tab Data in order to update this"):l.a.createElement("div",{onClick:function(){return f(!0)},className:"flex items-center cursor-pointer"},l.a.createElement("img",{src:"/img/edit-blue.svg"}),l.a.createElement("p",{className:"ml-10"},"Edit")))),tabList:d._selectedLanguages.map((function(e){return{key:e.key,tab:e.label}})),defaultActiveTabKey:B.Object.keys(d.standardRates)[0],onTabChange:function(e){oe(e)}},l.a.createElement(D.a,{pagination:!1,columns:Y(e.isDurationTypeAccompanying,d,"Language"),dataSource:null===(t=d.standardRates[le||B.Object.keys(d.standardRates)[0]])||void 0===t?void 0:t.rates.map((function(a){return{city:l.a.createElement("p",{className:"semibold"},(null===a||void 0===a?void 0:a.city)?null===a||void 0===a?void 0:a.city.name:"PAN India"),with_accommodation:"".concat(e.currencySymbol," ").concat(a.withAccommodationCharge),without_accommodation:"".concat(e.currencySymbol," ").concat(a.withoutAccommodationCharge)}}))}))}():l.a.createElement(C.a,{type:"inner",className:"mt-40",title:l.a.createElement("div",{className:"flex flex-col"},l.a.createElement("p",null,"Laguage Surcharge"," ",l.a.createElement("span",{className:"text-12 light"},"(optional)"),e.isLanguagePricesSaved&&v.k),l.a.createElement("p",{className:"mt-6 text-12 light"},"Guests breakdown & surcharge over specific languages")),extra:l.a.createElement(l.a.Fragment,null,Object(v.m)(e.tabStatus)?l.a.createElement("div",null):l.a.createElement("div",{onClick:function(){return f(!0)},className:"flex items-center cursor-pointer"},l.a.createElement("img",{src:"/img/edit-blue.svg"}),l.a.createElement("p",{className:"ml-10"},"Edit")))},l.a.createElement("div",{className:"form-grid grid-1 mb-30"},l.a.createElement("div",null,l.a.createElement("p",null,"Guests breakdown:"," ",l.a.createElement("span",{className:"semibold capitalize"},d._selectedSlabs.map((function(e,a){return l.a.createElement(l.a.Fragment,null,a>0&&" | ","Slab ".concat(a+1," (").concat(e[0],"-").concat(e[1]," guests)"))})))),l.a.createElement("p",null,"Exceptional Languages:"," ",l.a.createElement("span",{className:"semibold"},d._selectedLanguages.map((function(e){return e.label})).join(", "))))),l.a.createElement("div",null,l.a.createElement(D.a,{pagination:!1,columns:Y(e.isDurationTypeAccompanying,d),dataSource:H()}))),l.a.createElement(y.a,{visible:p,keyboard:!1,footer:null,width:"664px",destroyOnClose:!0,className:"language-surcharge-modal",closeIcon:l.a.createElement("img",{onClick:function(){return f(!1)},alt:"close",src:"/img/black-cancel-circle.svg"})},l.a.createElement("div",{id:"language-surcharge-modal"},l.a.createElement(q.e,{enableReinitialize:!0,initialValues:d,onSubmit:function(){var a=Object(L.a)(_.a.mark((function a(t,n){var c;return _.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:c=n.setSubmitting,(0,n.validateForm)().then(function(){var a=Object(L.a)(_.a.mark((function a(n){var i,l;return _.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if("product-guide-breakdown"!=te||0!==(null===(i=B.Object.keys(n))||void 0===i?void 0:i.length)||n.hasOwnProperty("defaultLanguage")){a.next=5;break}ne("product-guide-pricing"),c(!1),a.next=16;break;case 5:if(!e.isDurationTypeAccompanying){a.next=12;break}return l=$(t,e.isPanIndia),a.next=9,e.updateAccompanyingLanguagePrices(o,e.contractId,l);case 9:f(!1),a.next=16;break;case 12:return l=Z(t,e.isPanIndia,e.isDurationTypeAccompanying),a.next=15,e.updateLocalLanguagePrices(o,e.contractId,l);case 15:f(!1);case 16:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}());case 2:case"end":return a.stop()}}),a)})));return function(e,t){return a.apply(this,arguments)}}()},(function(a){var t=a.setFieldValue,c=a.isSubmitting,i=a.values,o=a.errors,r=a.validateForm;return l.a.createElement(l.a.Fragment,null,l.a.createElement("p",{className:"capitalize bold text-26"},"Update Language Surcharge"),l.a.createElement("p",{className:"capitalize bold text-16 light"},e.contractName||"--"),l.a.createElement(E.a,null),l.a.createElement(q.d,null,e.isDurationTypeAccompanying?l.a.createElement("div",null,l.a.createElement(q.b,{component:M.d,name:"_selectedLanguages",label:"Select exceptional Languages",value:i._selectedLanguages,getPopupContainer:function(){return document.getElementById("language-surcharge-modal")},disableOptionsOn:function(a){var t;return(null===(t=e.defaultPricingLanguage)||void 0===t?void 0:t.code)===a.code},optionValueKey:"code",showSearch:!0,mode:"multiple",onSelect:function(e){t("_selectedLanguages",[].concat(Object(k.a)(i._selectedLanguages),[e])),t("standardRates",Object(n.a)(Object(n.a)({},i.standardRates),{},Object(P.a)({},e.key,{language:{code:e.key,name:e.label},isDefaultLanguage:!1,rates:I})))},onDeselect:function(e){var a=i._selectedLanguages.filter((function(a){return a.value!==e.value}));t("_selectedLanguages",a);var c=Object(n.a)({},i.standardRates);delete c[e.key],t("standardRates",c)},showArrow:!0,labelInValue:!0,allowClear:!0,selectOptions:w,onClear:V,onSearch:V,hasFeedback:!0,filterOption:!1}),B.Object.entries(i.standardRates).map((function(e){return l.a.createElement(C.a,{type:"inner",size:"small",className:"mt-40 tabs-dark",tabList:[{key:e[1].language.name,tab:e[1].language.name}]},function(e,a,t){return l.a.createElement("table",null,l.a.createElement("thead",null,l.a.createElement("td",null,"City"),e._selectedSlabs.map((function(e,a){return l.a.createElement("td",{className:"capitalize"},null===e||void 0===e?void 0:e.split("_").join(" "))}))),l.a.createElement("tbody",null,t.map((function(t,n){var c;return l.a.createElement("tr",null,l.a.createElement("td",null,(null===(c=t.city)||void 0===c?void 0:c.name)||"PAN India"),l.a.createElement("td",null,l.a.createElement(q.b,{component:M.b,name:"standardRates[".concat(a,"].rates.[").concat(n,"].withAccommodationCharge"),required:!0,value:e["standardRates[".concat(a,"].rates.[").concat(n,"].withAccommodationCharge")],type:"number"})),l.a.createElement("td",null,l.a.createElement(q.b,{component:M.b,name:"standardRates[".concat(a,"].rates.[").concat(n,"].withoutAccommodationCharge"),required:!0,value:e["standardRates[".concat(a,"].rates.[").concat(n,"].withoutAccommodationCharge")],type:"number"})))}))))}(i,e[0],e[1].rates))})),l.a.createElement("div",{className:"mt-30 flex justify-flex-start"},l.a.createElement(j.a,{loading:c,type:"primary",htmlType:"submit"},c?"Updating...":"Update Language Surcharge"))):l.a.createElement(F.a,{activeKey:te,onChange:function(e){return ne(e)},className:"mt-20 tabs-dark"},l.a.createElement(ee,{tab:l.a.createElement("div",{className:"flex justify-between items-center"},l.a.createElement("p",null,"Breakdown")),key:"product-guide-breakdown"},l.a.createElement("p",{className:"mb-12 text-14 bold capitalize"},"Languages"),l.a.createElement(q.b,{component:M.d,name:"_selectedLanguages",label:"Select exceptional Languages",value:i._selectedLanguages,getPopupContainer:function(){return document.getElementById("language-surcharge-modal")},disableOptionsOn:function(a){var t;return(null===(t=e.defaultPricingLanguage)||void 0===t?void 0:t.code)===a.code},optionValueKey:"code",showSearch:!0,mode:"multiple",onSelect:function(e){t("_selectedLanguages",[].concat(Object(k.a)(i._selectedLanguages),[e]))},onDeselect:function(e){var a=i._selectedLanguages.filter((function(a){return a.value!==e.value}));t("_selectedLanguages",a)},allowClear:!0,showArrow:!0,labelInValue:!0,selectOptions:w,onClear:V,onSearch:V,hasFeedback:!0,filterOption:!1}),l.a.createElement("p",{className:"mb-12 text-14 bold capitalize"},"Guests breakdown"),l.a.createElement(X,{values:i,errors:o,fieldName:"_selectedSlabs",defaultSlabs:e.defaultSlabs,className:"flex-1",setFieldValue:t,validateForm:r,selectedSlabs:i._selectedSlabs}),l.a.createElement("div",{className:"mt-30 flex justify-flex-start"},l.a.createElement(j.a,{htmlType:"submit",type:"primary"},"Continue"))),l.a.createElement(ee,{tab:l.a.createElement("div",{className:"flex justify-between items-center"},l.a.createElement("p",null,"Pricing")),key:"product-guide-pricing"},l.a.createElement(D.a,{pagination:!1,columns:se(i),dataSource:ue(i)}),l.a.createElement("div",{className:"mt-30 flex justify-flex-start"},l.a.createElement(j.a,{loading:c,type:"primary",htmlType:"submit"},c?"Updating...":"Update Language Surcharge"))))))})))))})),te=(t(118),t(54)),ne=t.n(te);t(3892),F.a.TabPane,T.a.Text,T.a.Link,T.a.Title;var ce=Object(o.b)((function(e){var a,t,n=e.Products.guide,c=n.contract,i=n.basicDetails;return{contract:c,isOutstationSaved:null===c||void 0===c||null===(a=c.localOutstationPrices)||void 0===a?void 0:a.isDataSaved,contractName:null===i||void 0===i||null===(t=i.data)||void 0===t?void 0:t.name,tabStatus:n.tabStatus.status}}),(function(e){return{updateLocalOutstationPrices:Object(s.b)(b.y,e)}}))((function(e){var a,t,n,o,s,u,d,m,b,g,p=Object(r.i)(),f=p.id,O=(p.productType,Object(i.useState)({isOutstationSupplementApplicable:!0,outstationSupplementCharge:""})),h=Object(c.a)(O,2),S=h[0],x=h[1],k=Object(i.useState)(!1),P=Object(c.a)(k,2),w=P[0],A=P[1];e.rateCardIndexToEdit;Object(i.useEffect)((function(){var a,t,n,c,i,l;x({isOutstationSupplementApplicable:null===(a=e.contract)||void 0===a||null===(t=a.localOutstationPrices)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.isOutstationSupplementApplicable,outstationSupplementCharge:null===(c=e.contract)||void 0===c||null===(i=c.localOutstationPrices)||void 0===i||null===(l=i.data)||void 0===l?void 0:l.outstationSupplementCharge})}),[e.contract]);var D=function(){var a=Object(L.a)(_.a.mark((function a(t,n){return _.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.updateLocalOutstationPrices(f,e.contractId,t);case 2:A(!1),n(!1);case 4:case"end":return a.stop()}}),a)})));return function(e,t){return a.apply(this,arguments)}}(),R=!!(null===(a=e.loader)||void 0===a?void 0:a.isFetching);return l.a.createElement(l.a.Fragment,null,l.a.createElement(C.a,{type:"inner",className:"mt-40",title:l.a.createElement("div",{className:"flex flex-col"},l.a.createElement("p",null,"Outstation Supplement"," ",l.a.createElement("span",{className:"text-12 light"},"(optional)"),e.isOutstationSaved&&v.k),l.a.createElement("p",{className:"mt-6 text-12 light"},"Flat Price")),extra:l.a.createElement(l.a.Fragment,null,Object(v.m)(e.tabStatus)?l.a.createElement("div",null):l.a.createElement("div",{onClick:function(){return A(!0)},className:"flex items-center cursor-pointer"},l.a.createElement("img",{src:"/img/edit-blue.svg"}),l.a.createElement("p",{className:"ml-10"},"Edit")))},R?l.a.createElement(N.a,{active:!0}):l.a.createElement("div",{className:"flex justify-between"},l.a.createElement("p",null,(null===(t=e.contract)||void 0===t||null===(n=t.localOutstationPrices)||void 0===n||null===(o=n.data)||void 0===o?void 0:o.outstationSupplementCharge)?" ".concat(null===(s=e.contract)||void 0===s||null===(u=s.localOutstationPrices)||void 0===u||null===(d=u.data)||void 0===d?void 0:d.outstationSupplementCharge):"None"),l.a.createElement(ne.a,{disabled:!0,checked:null===(m=e.contract)||void 0===m||null===(b=m.localOutstationPrices)||void 0===b||null===(g=b.data)||void 0===g?void 0:g.isOutstationSupplementApplicable},"Applicable"))),l.a.createElement(y.a,{visible:w,keyboard:!1,footer:null,destroyOnClose:!0,width:"564px",className:"outstation-supplement-modal",closeIcon:l.a.createElement("img",{onClick:function(){return A(!1)},alt:"close",src:"/img/black-cancel-circle.svg"})},l.a.createElement("div",{id:"outstation-supplement-modal"},l.a.createElement(q.e,{enableReinitialize:!0,initialValues:S,onSubmit:function(e,a){var t=a.setSubmitting;D(e,t)}},(function(a){a.setFieldValue;var t=a.isSubmitting,n=a.values;return l.a.createElement(l.a.Fragment,null,l.a.createElement("p",{className:"capitalize bold text-26"},"Update Outstation Supplement"),l.a.createElement("p",{className:"capitalize bold text-16 light"},e.contractName||"--"),l.a.createElement(E.a,null),l.a.createElement(q.d,null,l.a.createElement("div",{className:"mt-20 mb-30"},l.a.createElement("div",{className:"form-grid grid-2"},l.a.createElement(q.b,{component:M.b,name:"outstationSupplementCharge",label:"Enter Flat Price *",value:n.outstationSupplementCharge,required:!!n.isOutstationSupplementApplicable,validate:function(e){return Object(v.s)(e)},type:"number"})),l.a.createElement("label",null,l.a.createElement(q.b,{name:"isOutstationSupplementApplicable",as:ne.a,type:"checkbox"}),l.a.createElement("span",{className:"semibold capitalize ml-10"},"Is Applicable?"))),l.a.createElement("div",{className:"mt-30 flex justify-flex-start"},l.a.createElement(j.a,{loading:t,type:"primary",htmlType:"submit"},t?"Updating...":"Update Outstation Supplement"))))})))))})),ie=t(56),le=function(e,a){var t=e._selectedCities.map((function(a){return e._selectedSlabs.reduce((function(t,n){var c="".concat(n[0],"-").concat(n[1]),i="".concat(c,"-").concat(a.key,"-").concat(a.label),l={allCities:!1,city:null===a||void 0===a?void 0:a.value,charge:+e.standardRates[i],slab:{min:+n[0],max:+n[1]}};return[].concat(Object(k.a)(t),[l])}),[])}));if(t=t.flat(),a){var c=e._selectedSlabs.reduce((function(a,t){var n="".concat(t[0],"-").concat(t[1]),c="".concat(n,"-pan"),i={allCities:!0,city:"",charge:+e.standardRates[c],slab:{min:+t[0],max:+t[1]}};return[].concat(Object(k.a)(a),[i])}),[]);t=[].concat(Object(k.a)(t),Object(k.a)(c))}var i=t,l={defaultLanguage:e.defaultLanguage,standardRates:i},o=l.standardRates.reduce((function(e,a){var t="".concat(a.slab.min,"-").concat(a.slab.max);return e=e.hasOwnProperty(t)?Object(n.a)(Object(n.a)({},e),{},Object(P.a)({},t,{rates:[].concat(Object(k.a)(e[t].rates),[{charge:a.charge,isPANCountry:!!a.allCities,city:a.city?a.city:null}])})):Object(n.a)(Object(n.a)({},e),{},Object(P.a)({},t,{rates:[{charge:a.charge,isPANCountry:!!a.allCities,city:a.city?a.city:null}]}))}),{});return{slabs:Object.entries(o).map((function(e){var a=e[0].split("-");return{min:a[0],max:a[1],rates:e[1].rates}})),defaultLanguage:l.defaultLanguage,cities:Array.from(new Set(l.standardRates.filter((function(e){return!!e.city})).map((function(e){return e.city}))))}},oe=function(e,a){var t=e._selectedCities.map((function(a){return{isPANCountry:!1,city:null===a||void 0===a?void 0:a.value,withAccommodationCharge:+e.standardRates["with_accommodation-".concat(a.key,"-").concat(a.label)],withoutAccommodationCharge:+e.standardRates["without_accommodation-".concat(a.key,"-").concat(a.label)]}}));return a&&t.unshift({isPANCountry:!0,withAccommodationCharge:+e.standardRates["with_accommodation-pan"],withoutAccommodationCharge:+e.standardRates["without_accommodation-pan"]}),{cities:e._selectedCities.map((function(e){return e.value})),baseLanguage:e.defaultLanguage,baseLanguageRates:t}},re=(t(3893),F.a.TabPane);var se=Object(o.b)((function(e,a){var t,n,c,i,l,o,r,s,u,d,m,b,v,g,p,f=e.Products.guide,y=f.basicDetails,O=f.contract,j=(null===O||void 0===O||null===(t=O.contractDetails)||void 0===t||null===(n=t.data)||void 0===n||null===(c=n.currency)||void 0===c?void 0:c.symbol)||"",h=!("accompanying"!=(null===(i=y.data)||void 0===i?void 0:i.type)),E=[];return E=h?null===(v=O.accompanyingPrices)||void 0===v?void 0:v.data.map((function(e){return e.language.code})):null===(g=O.localLanguagePrices)||void 0===g||null===(p=g.data)||void 0===p?void 0:p.map((function(e){var a;return null===(a=e.language)||void 0===a?void 0:a.code})),{currencySymbol:j,basicDetails:y,contract:O,contractName:null===y||void 0===y||null===(l=y.data)||void 0===l?void 0:l.name,languageSurchargesCodes:E,tabStatus:f.tabStatus.status,defaultSlabs:null===(o=y.data)||void 0===o?void 0:o.audience,isPricingSaved:(null===O||void 0===O||null===(r=O.localStandardPrices)||void 0===r?void 0:r.isDataSaved)||(null===O||void 0===O||null===(s=O.accompanyingPrices)||void 0===s?void 0:s.isDataSaved),cities:(null===(u=y.data)||void 0===u||null===(d=u.location)||void 0===d?void 0:d.cities)||[],isDurationTypeAccompanying:h,isPanIndia:!!(null===(m=y.data)||void 0===m||null===(b=m.location)||void 0===b?void 0:b.isPANCountry)}}),(function(e){return{getCityListNoParams:Object(s.b)(G.b,e),updateLocalStandardPrices:Object(s.b)(b.z,e),updateAccompanyingPrices:Object(s.b)(b.t,e)}}))((function(e){var a,t,o,s,u=Object(r.i)(),d=u.id,m=(u.productType,Object(i.useState)([])),b=Object(c.a)(m,2),g=b[0],p=b[1],f=Object(i.useState)("product-guide-breakdown"),O=Object(c.a)(f,2),h=O[0],S=O[1],x=Object(i.useState)(!1),w=Object(c.a)(x,2),A=w[0],R=w[1],T=Object(i.useState)(""),I=Object(c.a)(T,2),z=I[0],U=I[1],G=Object(i.useState)({defaultLanguage:"",_selectedCities:[],_selectedSlabs:[],standardRates:{}}),K=Object(c.a)(G,2),W=K[0],J=K[1],H=!!(null===(a=e.loader)||void 0===a?void 0:a.isFetching),Q=Object(ie.i)(),Z=Object(c.a)(Q,3),$=Z[0],ee=Z[1],ae=Z[2],te=Object(v.d)(Object(L.a)(_.a.mark((function a(){var t,n,c=arguments;return _.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return t=c.length>0&&void 0!==c[0]?c[0]:"",a.next=3,e.getCityListNoParams(t);case 3:n=a.sent,p((null===n||void 0===n?void 0:n.content)||[]);case 5:case"end":return a.stop()}}),a)}))),300),ne=function(a){var t=[{title:"City",dataIndex:"city",key:"city"}];return t=e.isDurationTypeAccompanying?[].concat(Object(k.a)(t),Object(k.a)(a._selectedSlabs.map((function(e,a){return{title:null===e||void 0===e?void 0:e.split("_").join(" "),dataIndex:e,key:e}})))):[].concat(Object(k.a)(t),Object(k.a)(a._selectedSlabs.map((function(e,a){return{title:"Slab ".concat(a+1," (").concat(e[0],"-").concat(e[1]," guests)"),dataIndex:"".concat(e[0],"-").concat(e[1]),key:"".concat(e[0],"-").concat(e[1])}}))))},ce=function(a){var t=[];return e.isPanIndia&&(t=[].concat(Object(k.a)(t),[Object(n.a)({city:"PAN India"},a._selectedSlabs.reduce((function(t,c,i){var o=e.isDurationTypeAccompanying?"".concat(c):"".concat(c[0],"-").concat(c[1]),r=e.isDurationTypeAccompanying?"".concat(c,"-pan"):"".concat(c[0],"-").concat(c[1],"-pan");return Object(n.a)(Object(n.a)({},t),{},Object(P.a)({},o,l.a.createElement(q.b,{component:M.b,name:"standardRates.".concat(r),value:Object(v.g)(a,"standardRates.".concat(r),""),type:"number",label:"Price",min:"0",required:!0,step:"any"})))}),{}))])),a._selectedCities.forEach((function(c,i){t=e.isDurationTypeAccompanying?[].concat(Object(k.a)(t),[Object(n.a)({city:"".concat(c.label)},a._selectedSlabs.reduce((function(e,t,i){var o="".concat(t);return Object(n.a)(Object(n.a)({},e),{},Object(P.a)({},o,l.a.createElement(q.b,{component:M.b,name:"standardRates[".concat(t,"-").concat(c.key,"-").concat(c.label,"]"),value:Object(v.g)(a,"standardRates.".concat(t,"-").concat(c.key,"-").concat(c.label),""),label:"Price",required:!0,min:"0",type:"number",step:"any"})))}),{}))]):[].concat(Object(k.a)(t),[Object(n.a)({city:"".concat(c.label)},a._selectedSlabs.reduce((function(e,t,i){var o="".concat(t[0],"-").concat(t[1]);return Object(n.a)(Object(n.a)({},e),{},Object(P.a)({},o,l.a.createElement(q.b,{component:M.b,name:"standardRates[".concat(t[0],"-").concat(t[1],"-").concat(c.key,"-").concat(c.label,"]"),value:Object(v.g)(a,"standardRates.".concat(t[0],"-").concat(t[1],"-").concat(c.key,"-").concat(c.label),""),label:"Price",required:!0,type:"number",min:"0",step:"any"})))}),{}))])})),t};return Object(i.useEffect)((function(){var a,t,c;te();var i,l,o,r,s,u,d,m,b,g={},f={};e.isDurationTypeAccompanying?g=(null===(r=i=(null===(l=e.contract.accompanyingPrices)||void 0===l||null===(o=l.data)||void 0===o?void 0:o.find((function(e){return e.isDefaultLanguage})))||[])||void 0===r?void 0:r.language)||{}:(i=(null===(s=e.contract.localStandardPrices)||void 0===s||null===(u=s.data)||void 0===u?void 0:u.price)||[],g=(null===(d=e.contract.localStandardPrices)||void 0===d||null===(m=d.data)||void 0===m?void 0:m.defaultLanguage)||{},(e.cities||[]).map((function(e){e&&(f[null===e||void 0===e?void 0:e.code]=e)})),e.isPanIndia&&(i||[]).map((function(e){var a=e.city;a&&(f[null===a||void 0===a?void 0:a.code]=a)})));ee(g),(null===(a=g)||void 0===a?void 0:a.code)||(te(),ae()),U(null===(t=g)||void 0===t?void 0:t.name);var y={};if(e.isDurationTypeAccompanying)b=["with_accommodation","without_accommodation"],(e.cities||[]).map((function(e){f[null===e||void 0===e?void 0:e.code]=e,y["with_accommodation-".concat(null===e||void 0===e?void 0:e.code,"-").concat(null===e||void 0===e?void 0:e.name)]="",y["without_accommodation-".concat(null===e||void 0===e?void 0:e.code,"-").concat(null===e||void 0===e?void 0:e.name)]=""})),Object(v.g)(i,"rates",[]).forEach((function(e){var a,t,n,c,i;(null===e||void 0===e?void 0:e.allCities)?(y["with_accommodation-pan"]=+e.withAccommodationCharge,y["without_accommodation-pan"]=+e.withoutAccommodationCharge):(f[null===e||void 0===e||null===(a=e.city)||void 0===a?void 0:a.code]=null===e||void 0===e?void 0:e.city,y["with_accommodation-".concat(null===e||void 0===e||null===(t=e.city)||void 0===t?void 0:t.code,"-").concat(null===e||void 0===e||null===(n=e.city)||void 0===n?void 0:n.name)]=+e.withAccommodationCharge,y["without_accommodation-".concat(null===e||void 0===e||null===(c=e.city)||void 0===c?void 0:c.code,"-").concat(null===e||void 0===e||null===(i=e.city)||void 0===i?void 0:i.name)]=+e.withoutAccommodationCharge)}));else{var O,j;if(b={},i.map((function(e,a){var t,n,c,i;b["".concat(null===(t=e.slab)||void 0===t?void 0:t.min,"-").concat(null===(n=e.slab)||void 0===n?void 0:n.max)]={min:null===(c=e.slab)||void 0===c?void 0:c.min,max:null===(i=e.slab)||void 0===i?void 0:i.max}})),0===B.Object.keys(b).length)b=Object(P.a)({},"".concat(null===(O=e.defaultSlabs)||void 0===O?void 0:O.min,"-").concat(null===(j=e.defaultSlabs)||void 0===j?void 0:j.max),e.defaultSlabs);b=B.Object.keys(b).map((function(e){return null===e||void 0===e?void 0:e.split("-")})).sort((function(e,a){return+e[0]-+a[0]})),i.map((function(e){var a,t,n,c,i,l,o=e.city?"".concat(null===e||void 0===e||null===(a=e.slab)||void 0===a?void 0:a.min,"-").concat(null===e||void 0===e||null===(t=e.slab)||void 0===t?void 0:t.max,"-").concat(null===e||void 0===e||null===(n=e.city)||void 0===n?void 0:n.code,"-").concat(null===e||void 0===e||null===(c=e.city)||void 0===c?void 0:c.name):"".concat(null===e||void 0===e||null===(i=e.slab)||void 0===i?void 0:i.min,"-").concat(null===e||void 0===e||null===(l=e.slab)||void 0===l?void 0:l.max,"-pan");y[o]=e.charge}))}p(B.Object.entries(f).map((function(e){return e[1]}))),J(Object(n.a)(Object(n.a)({},W),{},{defaultLanguage:(null===(c=g)||void 0===c?void 0:c.code)||"",_selectedCities:B.Object.entries(f).map((function(e){return{label:e[1].name,value:e[1].code,key:e[1].code}})),_selectedSlabs:b,standardRates:y}))}),[null===(t=e.contract.localStandardPrices.data)||void 0===t?void 0:t.price,null===(o=e.contract.accompanyingPrices)||void 0===o?void 0:o.data,e.cities]),l.a.createElement("div",null,l.a.createElement(C.a,{type:"inner",className:"mt-40",title:l.a.createElement("div",{className:"flex flex-col"},l.a.createElement("p",null,"Pricing *",e.isPricingSaved?v.k:l.a.createElement(V.a,{className:"ml-10",twoToneColor:"#ea9300"})),l.a.createElement("p",{className:"mt-6 text-12 light"},"Base language & guests breakdown")),extra:l.a.createElement(l.a.Fragment,null,Object(v.m)(e.tabStatus)||H?l.a.createElement("div",null):l.a.createElement("div",{onClick:function(){return R(!0)},className:"flex items-center cursor-pointer"},l.a.createElement("img",{src:"/img/edit-blue.svg"}),l.a.createElement("p",{className:"ml-10"},"Edit")))},H?l.a.createElement(N.a,{active:!0}):l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"form-grid grid-1 mb-30"},l.a.createElement("div",null,l.a.createElement("p",null,"Base Language:"," ",l.a.createElement("span",{className:"semibold"},z)),l.a.createElement("p",null,"Guests breakdown:"," ",l.a.createElement("span",{className:"semibold capitalize"},e.isDurationTypeAccompanying?Object(v.g)(W,"_selectedSlabs",[]).map((function(e){return String(e).split("_").join(" ")})).join(" "):Object(v.g)(W,"_selectedSlabs",[]).map((function(e,a){return"Slab ".concat(a+1," (").concat(e[0],"-").concat(e[1]," guests)")})).join(" | "))),l.a.createElement("p",null,"Exceptional cities:"," ",l.a.createElement("span",{className:"semibold"},(null===W||void 0===W||null===(s=W._selectedCities)||void 0===s?void 0:s.length)?null===W||void 0===W?void 0:W._selectedCities.map((function(e){return e.label})).join(", "):"--")))),l.a.createElement("div",null,l.a.createElement(D.a,{pagination:!1,columns:Y(e.isDurationTypeAccompanying,W,"City"),dataSource:function(a){var t=W._selectedCities.reduce((function(a,t){var c,i=null===(c=W._selectedSlabs)||void 0===c?void 0:c.reduce((function(a,c){var i=e.isDurationTypeAccompanying?"".concat(c):"".concat(c[0],"-").concat(c[1]),l="".concat(i,"-").concat(t.key,"-").concat(t.label);return Object(n.a)(Object(n.a)({},a),{},Object(P.a)({},i,"".concat(W.standardRates[l]?e.currencySymbol+W.standardRates[l]:"--")))}),{});return i=Object(n.a)(Object(n.a)({},i),{},{city:l.a.createElement("span",{className:"semibold"},t.label)}),[].concat(Object(k.a)(a),[i])}),[]);if(e.isPanIndia){var c,i=null===(c=W._selectedSlabs)||void 0===c?void 0:c.reduce((function(a,t){var c=e.isDurationTypeAccompanying?"".concat(t):"".concat(t[0],"-").concat(t[1]),i="".concat(c,"-pan");return Object(n.a)(Object(n.a)({},a),{},Object(P.a)({},c,"".concat(W.standardRates[i]?e.currencySymbol+W.standardRates[i]:"--")))}),{});t=[i=Object(n.a)(Object(n.a)({},i),{},{city:l.a.createElement("span",{className:"semibold"},"PAN")})].concat(Object(k.a)(t))}return t}()})))),l.a.createElement(y.a,{visible:A,keyboard:!1,footer:null,destroyOnClose:!0,style:{minWidth:"664px"},className:"pricing-modal",closeIcon:l.a.createElement("img",{onClick:function(){return R(!1)},alt:"close",src:"/img/black-cancel-circle.svg"})},l.a.createElement("div",{id:"pricing-modal"},l.a.createElement(q.e,{enableReinitialize:!0,initialValues:W,onSubmit:function(a,t){var n=t.setSubmitting;(0,t.validateForm)().then(function(){var t=Object(L.a)(_.a.mark((function t(c){var i,l;return _.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("product-guide-breakdown"!=h||0!==(null===(i=B.Object.keys(c))||void 0===i?void 0:i.length)||c.hasOwnProperty("defaultLanguage")){t.next=5;break}S("product-guide-pricing"),n(!1),t.next=16;break;case 5:if(!e.isDurationTypeAccompanying){t.next=12;break}return l=oe(a,e.isPanIndia),t.next=9,e.updateAccompanyingPrices(d,e.contractId,l);case 9:R(!1),t.next=16;break;case 12:return l=le(a,e.isPanIndia),t.next=15,e.updateLocalStandardPrices(d,e.contractId,l);case 15:R(!1);case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}},(function(a){var t=a.setFieldValue,n=a.isSubmitting,c=a.values,i=a.errors,o=a.validateForm;a.validateField;return l.a.createElement(l.a.Fragment,null,l.a.createElement("p",{className:"capitalize bold text-26"},"Update Prices"),l.a.createElement("p",{className:"capitalize bold text-16 light"},e.contractName||"--"),l.a.createElement(E.a,null),l.a.createElement(q.d,null,l.a.createElement(F.a,{activeKey:h,onChange:function(e){return S(e)},className:"mt-20 tabs-dark"},l.a.createElement(re,{tab:l.a.createElement("div",{className:"flex justify-between items-center"},l.a.createElement("p",null,"Breakdown")),key:"product-guide-breakdown"},l.a.createElement("p",{className:"mb-12 text-14 bold capitalize"},"Base Language"),l.a.createElement(q.b,{component:M.d,name:"defaultLanguage",label:"Select base language *",value:c.defaultLanguage,getPopupContainer:function(){return document.getElementById("pricing-modal")},disableOptionsOn:function(a){var t;return null===(t=e.languageSurchargesCodes)||void 0===t?void 0:t.includes(null===a||void 0===a?void 0:a.code)},validate:function(e){var a="";return e||(a="Base language is required"),a},allowClear:!0,optionValueKey:"code",showSearch:!0,selectOptions:$,onSearch:ae,onClear:ae,filterOption:!1,hasFeedback:!0}),e.isPanIndia&&l.a.createElement(q.b,{component:M.d,name:"_selectedCities",label:"Add exceptional cities",value:c._selectedCities,getPopupContainer:function(){return document.getElementById("pricing-modal")},optionValueKey:"code",showSearch:!0,mode:"multiple",onSelect:function(e){t("_selectedCities",[].concat(Object(k.a)(c._selectedCities),[e]))},onDeselect:function(e){var a=c._selectedCities.filter((function(a){return a.value!==e.value}));t("_selectedCities",a)},showArrow:!0,labelInValue:!0,selectOptions:g,onSearch:te,filterOption:!1}),!e.isDurationTypeAccompanying&&l.a.createElement(l.a.Fragment,null,l.a.createElement("p",{className:"mb-12 text-14 bold capitalize"},"Guests breakdown"),l.a.createElement(X,{values:c,errors:i,fieldName:"_selectedSlabs",defaultSlabs:e.defaultSlabs,className:"flex-1",setFieldValue:t,validateForm:o,selectedSlabs:c._selectedSlabs})),l.a.createElement("div",{className:"mt-30 flex justify-flex-start"},l.a.createElement(j.a,{htmlType:"submit",type:"primary"},"Continue"))),l.a.createElement(re,{tab:l.a.createElement("div",{className:"flex justify-between items-center"},l.a.createElement("p",null,"Pricing")),key:"product-guide-pricing"},l.a.createElement("div",{className:"guide-pricing-table"},l.a.createElement(D.a,{pagination:!1,columns:ne(c),dataSource:ce(c)})),l.a.createElement("div",{className:"mt-30 flex justify-flex-start"},l.a.createElement(j.a,{loading:n,type:"primary",htmlType:"submit"},n?"Updating...":"Update Pricing"))))))})))))}));t(3894);var ue=Object(o.b)((function(e){var a,t,n=e.Products,c=e.Language,i=e.Loader,l=n.guide,o=l.contracts,r=l.contract,s=l.basicDetails,u=c.languageList;return{contract:r,Loader:i,contracts:o.data,contractDetails:null===r||void 0===r||null===(a=r.contractDetails)||void 0===a?void 0:a.data,tabStatus:l.tabStatus.status,languageList:u,isDurationTypeAccompanying:"accompanying"===(null===(t=s.data)||void 0===t?void 0:t.type),isBasicDetailsSaved:l.basicDetails.isDataSaved}}),(function(e){return{getContractById:Object(s.b)(b.j,e),deleteContract:Object(s.b)(b.h,e),createContract:Object(s.b)(b.e,e),cloneContract:Object(s.b)(b.d,e),getServicesTariffs:Object(s.b)(b.l,e),updateContractDetails:Object(s.b)(b.v,e),getGuide:Object(s.b)(b.k,e),getLanguageList:Object(s.b)(m.a,e)}}))((function(e){var a,t,o,s,m,b=e.isBasicDetailsSaved,f=Object(v.q)(),y=f.get("tab"),O=f.get("stage"),j=f.get("contractId"),h=Object(r.i)(),E=h.id,S=(h.productType,Object(r.g)()),C=Object(i.useState)(!1),x=Object(c.a)(C,2),N=x[0],k=x[1];return Object(i.useEffect)((function(){e.getLanguageList()}),[]),Object(i.useEffect)((function(){j&&b&&(S.push({search:"stage=".concat(O,"&tab=").concat(y,"&contractId=").concat(j)}),e.getContractById(E,j,O))}),[j,b]),l.a.createElement("div",{className:"services-tariffs"},l.a.createElement(p.a,{hasAutoGenerateRateCode:!0,contractId:j,dataSource:e.contracts,businessCode:E,isFetching:null===(a=e.Loader[d.i])||void 0===a?void 0:a.isFetching,isReadOnlyMode:Object(v.m)(e.tabStatus),createContract:e.createContract,cloneContract:e.cloneContract,deleteContract:e.deleteContract,getContractListByFilters:e.getServicesTariffs},l.a.createElement(g.a,{hasAutoGenerateRateCode:!0,onCreate:null,onUpdate:function(a){var t={name:a.name,contractType:a.type,audience:a.audience||[],startDate:a.validity.start,endDate:a.validity.end,rateTypeCode:a.rateTypeCode,signatoryName:a.signatory.firstName,signatoryDesignation:a.signatory.designation,signingDate:a.signingDate,currency:a.currency,documents:a.documents,inclusiveOfTaxes:a.inclusiveOfTaxes,isForecastingAllowed:a.isForecastingAllowed,margin:a.margin};e.updateContractDetails(E,j,t).then((function(){return k(!1)}))},details:Object(n.a)(Object(n.a)({},e.contractDetails),{},{signatory:{firstName:null===(t=e.contractDetails)||void 0===t?void 0:t.signatoryName,designation:null===(o=e.contractDetails)||void 0===o?void 0:o.signatoryDesignation},validity:{start:null===(s=e.contractDetails)||void 0===s?void 0:s.validityStart,end:null===(m=e.contractDetails)||void 0===m?void 0:m.validityExpiry}}),contractTypes:u.a,addNewContractVisible:N,setAddNewContractVisible:k,isCompletelyFilled:!1,showCardDetails:!0,loader:e.Loader[d.i],isReadOnlyMode:Object(v.m)(e.tabStatus)}),l.a.createElement(se,{contractId:j,loader:e.Loader[d.i],isReadOnlyMode:Object(v.m)(e.tabStatus)}),l.a.createElement(ae,{contractId:j,loader:e.Loader[d.i],isReadOnlyMode:Object(v.m)(e.tabStatus)}),!e.isDurationTypeAccompanying&&l.a.createElement(l.a.Fragment,null,l.a.createElement(J,{contractId:j,isReadOnlyMode:Object(v.m)(e.tabStatus)}),l.a.createElement(ce,{contractId:j,loader:e.Loader[d.i],isReadOnlyMode:Object(v.m)(e.tabStatus)}))))}));a.default=ue}}]);